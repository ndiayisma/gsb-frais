{% extends 'base.html.twig' %}

{% block title %}Hello ComptableController!{% endblock %}

{% block body %}
    <div class="container mx-auto sm:px-4 md:px-8 lg:px-16 xl:px-24 2xl:px-32">
        <div class="py-8">
            <h1 class="text-2xl font-bold mb-4">Choisir un visiteur et un mois</h1>
        </div>

            {{ include('fiche_frais/_form.html.twig') }}


        <div class="container mx-auto">
            <div class="flex flex-wrap">
                {% if selectedFiche  %}
                    <div class="w-full md:w-1/3 p-2 ml-2 mr-2">
                        <div class="bg-white shadow-md rounded-lg mb-8">
                            <div class="p-4">
                                <h5 class="text-xl font-semibold mb-2">Visiteur: {{ selectedFiche.user.nom }} {{ selectedFiche.user.prenom }}</h5>
                                <h5 class="text-xl font-semibold mb-2">{{ selectedFiche.mois|date('F Y') }}</h5>
                                <p class="text-gray-700">Amount Validated: {{ selectedFiche.montantValid }}</p>
                                <p class="text-gray-700">Number of Justifications: {{ selectedFiche.nbJustifications }}</p>
                                <p class="text-gray-700">Modification Date: {{ selectedFiche.dateModif|date('Y-m-d') }}</p>
                                <p class="text-gray-700">Status: {{ selectedFiche.etat.libelle }}</p>
                            </div>
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>


        {% if selectedFiche %}
            <div class="flex flex-col space-y-8">
                <!-- First table - Standard expenses -->
                <div class="w-full overflow-x-auto rounded-xl shadow-md bg-white">
                    <div class="p-4">
                        <h2 class="text-lg font-semibold mb-3">Standard Expenses</h2>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="bg-gray-50">
                                <tr>
                                    {% for ligne in selectedFiche.ligneFraisForfaits %}
                                        <th class="py-2 px-4 border-b whitespace-nowrap">{{ ligne.fraisForfait.libelle }}</th>
                                    {% endfor %}
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    {% for ligne in selectedFiche.ligneFraisForfaits %}
                                        <td class="py-2 px-4 border-b whitespace-nowrap">{{ ligne.quantite }}</td>
                                    {% endfor %}
                                </tr>
                                </tbody>
                                <tbody>
                                <tr>
                                    {% for ligne in selectedFiche.ligneFraisForfaits %}
                                        <td class="py-2 px-4 border-b whitespace-nowrap">{{ ligne.TotalAmount}} €</td>
                                    {% endfor %}
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Second table - Additional expenses -->
                <div class="w-full overflow-x-auto rounded-xl shadow-md bg-white">
                    <div class="p-4">
                        <h2 class="text-lg font-semibold mb-3">Additional Expenses</h2>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left">
                                <thead class="bg-gray-50">
                                <tr>
                                    <th class="py-2 px-4 border-b whitespace-nowrap">Justification</th>
                                    <th class="py-2 px-4 border-b whitespace-nowrap">Amount</th>
                                    <th class="py-2 px-4 border-b whitespace-nowrap">Date</th>
                                </tr>
                                </thead>
                                <tbody>
                                {% for ligne in selectedFiche.ligneFraisHorsForfaits %}
                                    <tr>
                                        <td class="py-2 px-4 border-b">{{ ligne.libelle }}</td>
                                        <td class="py-2 px-4 border-b">{{ ligne.montant }}</td>
                                        <td class="py-2 px-4 border-b">{{ ligne.date|date('Y-m-d') }}</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <button class="bg-blue-500 text-white px-4 py-2 mb-2 rounded mt-4">
                <a href="{{ path('app_comptable_fiche', { 'id': selectedFiche.id }) }}">Détails</a></button>
            </div>

        {% endif %}

{% endblock %}